<!DOCTYPE HTML>
<!--
	Aerial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Rank of CJ Rush</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<script src="https://www.gstatic.com/firebasejs/7.10.0/firebase-app.js"></script>
		<script src="https://www.gstatic.com/firebasejs/7.10.0/firebase-firestore.js"></script>
		<style>
			.avatar {
			  vertical-align: middle;
			  width: 50px;
			  height: 50px;
			  border-radius: 50%;
			}
			.titlepic {
				vertical-align: middle;
				width: auto;
				height: 100px;
			}
		</style>
	</head>
	<body class="is-preload">
		<div id="wrapper">
			<div id="bg"></div>
			<div id="overlay"></div>
			<div id="main">

				<!-- Header -->
					<header id="header">
						<!--<h1>Adam Jensen</h1>-->
						<h1><img src="assets/css/images/title.png" alt="TitlePic" class="titlepic"></h1>
						<p id="NewStringBox"></p>
						<p id="UserStringBox"></p>
						<nav>
							<!--
							<ul>
								<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
								<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
								<li><a href="#" class="icon brands fa-dribbble"><span class="label">Dribbble</span></a></li>
								<li><a href="#" class="icon brands fa-github"><span class="label">Github</span></a></li>
								<li><a href="#" class="icon solid fa-envelope"><span class="label">Email</span></a></li>
							</ul>
							-->
						</nav>
					</header>

				<!-- Footer -->
					<footer id="footer">
						<span class="copyright">&copy; Design: Devole Studio</a>.</span>
					</footer>

			</div>
		</div>
		<script>
			var url = location.href;
			var LineUserId = "";
			var EnableShowUserScore = 0;
			if(url.indexOf('?')!=-1) {
				var UrlContent = url.split('?');
				LineUserId = UrlContent[1];
				EnableShowUserScore = 1;
			}
		</script>
		<script>
			// Initialize Firebase
			firebase.initializeApp({
				apiKey: "AIzaSyDz6zgdgvfifKU6qaablQcVbrE7_YvrP-E",
				authDomain: "cj-rush.firebaseapp.com",
				projectId: "cj-rush",
			});
	
			var WeddingDatabase = firebase.firestore();	
		</script>
		<script>
			window.onload = function() { document.body.classList.remove('is-preload'); }
			window.ontouchmove = function() { return false; }
			window.onorientationchange = function() { document.body.scrollTop = 0; }
		</script>
		<script>
			var RankString;
			var AwardCounter;
			WeddingDatabase.collection("cj_customers").where("score", ">", 0).orderBy("score", "desc").limit(5)
				.onSnapshot(function(querySnapshot) {
					RankString = "";
					AwardCounter = 0;
					querySnapshot.forEach(function(doc) {
						RankString = RankString + "<"+AwardTag(AwardCounter)+">"+AwardIcon(AwardCounter)+"<img src=\""+doc.data().picture_url+"\" onerror=\"this.onerror='';this.src='assets/css/images/default-avatar.png'\" alt=\"\" class=\"avatar\">"+ "&nbsp&nbsp&nbsp" +doc.data().name+ "&nbsp&nbsp&nbsp"+doc.data().score+"</"+AwardTag(AwardCounter)+">";
						AwardCounter++;
					});
					//console.log("RankList: ", RankList.join(", "));
					if (RankString == "") {
						RankString = "<h3><span style=\"font-size:150%;\">Â∞öÊú™Âá∫ÁèæÊåëÊà∞ËÄÖ„ÄÇÂø´‰æÜÁé©ÔºÅ</span></h3>";
					}
					ChangeString();
				});
		</script>
		<script>
			function ChangeString(){
				var NewStringValue=RankString;
				document.getElementById("NewStringBox").innerHTML=NewStringValue;
			}
		</script>	
		<script>
			function ChangeUserString(){
				var UserStringValue=UserString;
				document.getElementById("UserStringBox").innerHTML=UserStringValue;
			}
		</script>
		<script>
			var UserString;
			if (EnableShowUserScore == 1) {
				WeddingDatabase.collection("cj_customers").doc(LineUserId)
					.onSnapshot(function(doc) {
						UserScore = doc.data().score;
						UserString = "<h5>" + "Your Score: "+ UserScore+ "</h5>";
						ChangeUserString();
					});		
			}
		</script>				
		<script>
			function AwardIcon(nCounter){
				if (nCounter == 0) {
					return "ü•á";
				}
				if (nCounter == 1) {
					return "ü•à";
				}
				if (nCounter == 2) {
					return "ü•â";
				}
				return "";
			}
		</script>	
		<script>
			function AwardTag(nCounter){
				if (nCounter == 0) {
					return "h2";
				}
				if (nCounter == 1) {
					return "h3";
				}
				if (nCounter == 2) {
					return "h4";
				}
				return "p";
			}
		</script>
	</body>
</html>